import { Component, Input, EventEmitter, Output, ViewEncapsulation } from '@angular/core';
import { BreakpointObserver, Breakpoints } from '@angular/cdk/layout';
import { FormUtils, ObjectUtils, KeyMapUtils, ButtonUtils, CollectionUtils, FormCustomUtils, DependentUtils } from '../../../utility';
import { AbilityUtils } from '../../../utility/ability.utility';
import { Ability } from '@casl/ability';
export class FormComponent {
    // headerReload: boolean = false;
    //  unflatten = require('flat').unflatten;
    constructor(ability, breakpointObserver) {
        this.ability = ability;
        this.breakpointObserver = breakpointObserver;
        this.onFormChange = new EventEmitter();
        this.onFieldChange = new EventEmitter();
        this.onButtonClick = new EventEmitter();
        this.formFields = new Array();
        this.cellCount = 12;
        this.showButtons = true;
        this.formLayouts = new Array();
        this.formInitialized = true;
        AbilityUtils.setAbility(this.ability);
    }
    get formConfig() {
        return this._formConfig;
    }
    set formConfig(_formConfig) {
        this._formConfig = _formConfig;
        // this.headerReload = false;
        while (1) {
            if (this.formInitialized) {
                // setTimeout(() => {this.headerReload = true;}, 20);
                console.log("1");
                this.init();
                break;
            }
        }
    }
    get supportingRecord() {
        return this._supportingRecord;
    }
    set supportingRecord(_supportingRecord) {
        this._supportingRecord = _supportingRecord;
        this.initFormGroup();
    }
    get record() {
        return this._record;
    }
    set record(_record) {
        this._record = _record;
        if (this.originalData) { }
        else {
            this.originalData = this._record;
        }
        this.initFormGroup();
    }
    get reset() {
        return this._reset;
    }
    set reset(_reset) {
        this._reset = _reset;
        if (this._reset == true) {
            FormUtils.reset(this.form, this.formConfig);
        }
    }
    ngOnInit() {
        this.formInitialized = true;
    }
    init() {
        this.getLayout();
        this.getActions();
        //    this.fieldDefaultSetting();
        this.dependencies = Object.assign(Object.assign({}, DependentUtils.getDependencyTree(this.formConfig.formFields)), DependentUtils.getDependencyTreeForButton(this.formConfig.action));
        this.getCustomLayout();
    }
    getCustomLayout() {
        if (this.formConfig.showCustomLayout) {
            FormCustomUtils.setCustomLayout(this.formConfig, this.formConfig.layout);
        }
        else {
            this.formConfig.showCustomLayout = false;
        }
    }
    getActions() {
        if (this.formConfig && this.formConfig.action && this.formConfig.action.align && this.formConfig.action.buttons && this.formConfig.action.buttons.length > 0) {
            this.formButton = this.formConfig.action;
        }
        if (this.formConfig && this.formConfig.action && this.formConfig.action.cells && this.formConfig.action.cells.length > 0) {
            this.formButtonLayout = this.formConfig.action;
        }
    }
    dependentFieldChange(action) {
        if (this.formConfig.identifier == action.sourceIdentifier) {
            let newRecord = ObjectUtils.unflatten(this.form.getRawValue());
            this.record = Object.assign(Object.assign({}, this.record), newRecord);
            console.log(this.record);
            this.initFormGroup();
            this.showButtons = false;
            setTimeout(() => {
                this.showButtons = true;
            }, 50);
        }
    }
    fieldChange(fieldChange) {
        this.onFieldChange.emit(fieldChange);
        this.onFormChange.emit(this.form);
    }
    buttonClick(event) {
        this.onButtonClick.emit(event);
    }
    fieldDefaultSetting() {
        if (this.formConfig) {
            for (let formField of this.formConfig.formFields) {
                if (!formField.field.fieldDisplayType) {
                    formField.field.fieldDisplayType = this.formConfig.displayType;
                }
            }
            if (!this.formConfig.displayInColumns) {
                this.formConfig.displayInColumns = 1;
            }
        }
        this.setTitle();
    }
    setTitle() {
        if (this.formConfig.header) {
            let title = this.formConfig.header.title;
            switch (this.formConfig.displayMode) {
                case "ADD" /* ADD */:
                    if (this.formConfig.header.addModeTitle) {
                        title = this.formConfig.header.addModeTitle;
                    }
                    break;
                case "EDIT" /* EDIT */:
                    if (this.formConfig.header.editModeTitle) {
                        title = this.formConfig.header.editModeTitle;
                    }
                    break;
                case "VIEW" /* VIEW */:
                    if (this.formConfig.header.viewModeTitle) {
                        title = this.formConfig.header.viewModeTitle;
                    }
                    break;
                case "BLOCKED" /* BLOCKED */:
                    if (this.formConfig.header.viewModeTitle) {
                        title = this.formConfig.header.viewModeTitle;
                    }
                    break;
            }
            this.formConfig.header.title = title;
        }
    }
    initFormGroup() {
        KeyMapUtils.setOptionssUsingValues(this.keyMap, false, "FORM" /* FORM */, this.formConfig, this._record);
        this.form = FormUtils.initFormGroup(this.formConfig.formFields, this._supportingRecord, this._record, this.formConfig.displayMode);
        this.onFormChange.emit(this.form);
        if (this.isMobile || this.isTablet || this.isDesktop) {
            this.resetDisplayInColumn();
        }
    }
    // isValidButton(button: Button): boolean {
    //   let isValid: boolean = false;
    //   if (button.displayInFormModes.indexOf(this.formConfig.displayMode) > -1) {
    //     isValid = true;
    //   }
    //   return isValid;
    // }
    // isNewRow(index: number): string {
    //   let displayRow: string = "";
    //   if (index % this.formConfig.displayInColumns == 0) {
    //     displayRow = "row";
    //   }
    //   return displayRow;
    // }
    getFormValue() {
        return FormUtils.getRawValue(this.form);
    }
    transformRows() {
        let sectionLabel = "";
        let formLayouts = new Array();
        let index = -1;
        let displayInColumns = this.formConfig.displayInColumns;
        if (this.formConfig.formFields && this.form) {
            for (let formField of this.formConfig.formFields) {
                if (this.form.controls[formField.field.key] && DependentUtils.displayDependencyField(formField.field.dependentOnFields, this._supportingRecord, this._record)) {
                    if (formField.separator || sectionLabel == "") {
                        formLayouts.push({
                            sectionLabel: formField && formField.separator && formField.separator.label ? formField.separator.label : "",
                            sectionIcon: formField && formField.separator && formField.separator.icon ? formField.separator.icon : "",
                            sectionExpandable: formField && formField.separator && formField.separator.expandable ? formField.separator.expandable : null,
                            rows: new Array()
                        });
                        sectionLabel = "-";
                        index++;
                    }
                    if (formLayouts[index]) {
                        let rLength = formLayouts[index].rows.length;
                        if (formLayouts[index].rows.length == 0) {
                            formLayouts[index].rows.push({ columns: new Array() });
                            formLayouts[index].rows[0].columns = new Array();
                        }
                        let cLength = this.formFieldRowColumnCount(formLayouts, index);
                        if (cLength >= displayInColumns) {
                            formLayouts[index].rows[rLength] = { columns: new Array() };
                        }
                        formLayouts[index].rows[formLayouts[index].rows.length - 1].columns.push(formField);
                    }
                }
            }
        }
        this.formLayouts = formLayouts;
    }
    formFieldRowColumnCount(formLayouts, index) {
        let colCount = 0;
        for (let cCnt = 0; cCnt < formLayouts[index].rows[formLayouts[index].rows.length - 1].columns.length; cCnt++) {
            if (formLayouts[index].rows[formLayouts[index].rows.length - 1].columns[cCnt].displayInColumns) {
                colCount += formLayouts[index].rows[formLayouts[index].rows.length - 1].columns[cCnt].displayInColumns;
            }
            else {
                colCount += 1;
                formLayouts[index].rows[formLayouts[index].rows.length - 1].columns[cCnt].displayInColumns = 1;
            }
        }
        return colCount;
    }
    toggleList(formLayout) {
        if (formLayout.sectionExpandable && formLayout.sectionExpandable.allowed) {
            if (formLayout.sectionExpandable.default == "EXPAND" /* EXPAND */) {
                formLayout.sectionExpandable.default = "COLLAPSE" /* COLLAPSE */;
            }
            else {
                formLayout.sectionExpandable.default = "EXPAND" /* EXPAND */;
            }
        }
    }
    getLayout() {
        this.breakpointSubscription = this.breakpointObserver.observe([
            Breakpoints.XSmall,
            Breakpoints.Small,
            Breakpoints.Medium,
            Breakpoints.Large,
            Breakpoints.XLarge
        ]).subscribe((state) => {
            if (state.breakpoints[Breakpoints.XSmall]) {
                this.isMobile = true;
                console.log('Matches XSmall viewport');
            }
            if (state.breakpoints[Breakpoints.Small]) {
                this.isTablet = true;
                console.log('Matches Small viewport');
            }
            if (state.breakpoints[Breakpoints.Medium]) {
                this.isDesktop = true;
                console.log('Matches Medium  viewport');
            }
            if (state.breakpoints[Breakpoints.Large]) {
                this.isDesktop = true;
                console.log('Matches Large viewport');
            }
            if (state.breakpoints[Breakpoints.XLarge]) {
                this.isDesktop = true;
                console.log('Matches XLarge viewport');
            }
            this.resetButtonDisplay();
            this.resetDisplayInColumn();
        });
    }
    resetButtonDisplay() {
        if (this.formConfig && this.formConfig.action && !CollectionUtils.isEmpty(this.formConfig.action.buttons)) {
            if ((this.isMobile || this.isTablet) && !ButtonUtils.hasWidth(this.formConfig.action.buttons)) {
                ButtonUtils.setEqualWidth(this.formConfig.action.buttons);
            }
        }
    }
    resetDisplayInColumn() {
        if (this.formConfig && this.formConfig.displayInColumns) {
            if (this.isMobile) {
                this.cellCount = 4;
                this.formConfig.displayInColumns = this.getNewDisplayInColumn("mobile", this.formConfig.displayInColumns);
            }
            if (this.isTablet) {
                this.cellCount = 8;
                this.formConfig.displayInColumns = this.getNewDisplayInColumn("tablet", this.formConfig.displayInColumns);
            }
        }
        if (this.formConfig && !CollectionUtils.isEmpty(this.formConfig.formFields)) {
            this.formConfig.formFields.forEach(formField => {
                if (formField.displayInColumns) {
                    if (this.isMobile) {
                        this.cellCount = 4;
                        formField.displayInColumns = this.getNewDisplayInColumn("mobile", formField.displayInColumns);
                    }
                    if (this.isTablet) {
                        this.cellCount = 8;
                        formField.displayInColumns = this.getNewDisplayInColumn("tablet", formField.displayInColumns);
                    }
                }
                else {
                    formField.displayInColumns = 1;
                }
            });
        }
        this.fieldDefaultSetting();
        this.transformRows();
    }
    getNewDisplayInColumn(device, displayInColumn) {
        let displayInColumnMap = new Map();
        let mobileMap = new Map();
        mobileMap.set(12, 1);
        mobileMap.set(11, 1);
        mobileMap.set(10, 1);
        mobileMap.set(9, 1);
        mobileMap.set(8, 1);
        mobileMap.set(7, 1);
        mobileMap.set(6, 1);
        mobileMap.set(5, 1);
        mobileMap.set(4, 1);
        mobileMap.set(3, 1);
        mobileMap.set(2, 1);
        mobileMap.set(1, 1);
        displayInColumnMap.set("mobile", mobileMap);
        let tabletMap = new Map();
        tabletMap.set(12, 2);
        tabletMap.set(11, 2);
        tabletMap.set(10, 2);
        tabletMap.set(9, 2);
        tabletMap.set(8, 2);
        tabletMap.set(7, 2);
        tabletMap.set(6, 2);
        tabletMap.set(5, 2);
        tabletMap.set(4, 2);
        tabletMap.set(3, 2);
        tabletMap.set(2, 2);
        tabletMap.set(1, 1);
        displayInColumnMap.set("tablet", tabletMap);
        return displayInColumnMap.get(device).get(displayInColumn);
    }
    ngOnDestroy() {
        if (this.breakpointSubscription) {
            this.breakpointSubscription.unsubscribe();
        }
    }
}
FormComponent.decorators = [
    { type: Component, args: [{
                selector: 'mx-form',
                template: "<mat-card *ngIf=\"(isMobile || isTablet || isDesktop) && formConfig && (formConfig.permission == null || (formConfig.permission && (formConfig.permission['subject'] | can: formConfig.permission['action'])))\" class=\"mx-form-container\">\n  <!-- <mat-card *ngIf=\"formConfig && (formConfig.permission == null || (formConfig.permission && (formConfig.permission['subject'] | can: formConfig.permission['action'])))\"> -->\n  <!-- --{{formConfig.displayMode}}=== -->\n  <mx-form-header \n    *ngIf=\"formConfig.header && formConfig.header.title\"\n    class=\"mx-form-header\"\n    [formHeaderConfig]=\"formConfig.header\"  \n    [description]=\"formConfig.description\"\n    [help]=\"formConfig.help\"\n    [sourceIndex]=\"sourceIndex\"\n    [widgetArrayIndex]=\"widgetArrayIndex\"\n    [formIdentifier]=\"formConfig.identifier\"\n    [form]=\"form\"\n    [originalData]=\"originalData\"\n    [context]=\"getFormValue()\"\n    [formActions]=\"formConfig.header.actions\"\n    (onFieldChange)=\"fieldChange($event)\"\n    (onButtonClick)=\"buttonClick($event)\"\n    [formDisplayMode]=\"formConfig.displayMode\" \n  ></mx-form-header>  \n\n  <mat-card-content *ngIf=\"!formConfig.showCustomLayout\">\n    <div class=\"mdc-layout-grid mx-table\" *ngIf=\"formConfig.description && formConfig.description.text && formConfig.description.bgColor\">\n      <div class=\"mdc-layout-grid__inner\">\n        <div class=\"mdc-layout-grid__cell--span-{{cellCount}}\">\n          <div \n            class=\"mx-form-header-desc\"\n            [style.background-color]=\"formConfig.description.bgColor\"\n            [style.color]=\"formConfig.description.textColor\"\n          >\n            <mat-icon class=\"mx-form-header-desc-icon\" aria-hidden=\"true\" [attr.aria-label]=\"formConfig.description.icon\" *ngIf=\"formConfig.description.icon\">{{formConfig.description.icon}}</mat-icon>\n            <span>{{ formConfig.description.text }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n    <mat-divider class=\"mx-form-header-divider\" *ngIf=\"formConfig.formFields && formConfig.formFields.length > 0 && (formConfig.header && formConfig.header.title) && (!formConfig.description || !formConfig.description.bgColor)\"></mat-divider>\n    <mat-card-subtitle *ngIf=\"formConfig.description && formConfig.description.text && !formConfig.description.bgColor\">{{ formConfig.description.text }}</mat-card-subtitle>\n\n    <div class=\"fields-container\">\n      <mat-list *ngFor=\"let formLayout of formLayouts\">\n        <mat-list-item \n          *ngIf=\"formLayout.sectionLabel\" \n          class=\"mx-form-separator\" \n          (click)=\"toggleList(formLayout)\">\n          <mat-icon *ngIf=\"formLayout.sectionIcon\" matListIcon>{{ formLayout.sectionIcon }}</mat-icon>\n          <span>\n            <span [ngClass]=\"{'mx-form-separator-expandable': formLayout.sectionExpandable && formLayout.sectionExpandable.allowed}\">\n              {{formLayout.sectionLabel}}\n            </span>\n            <mat-icon class=\"mx-form-section-showhide\" *ngIf=\"formLayout.sectionExpandable && formLayout.sectionExpandable.allowed && formLayout.sectionExpandable.default == 'COLLAPSE'\" matListIcon>keyboard_arrow_down</mat-icon>\n            <mat-icon class=\"mx-form-section-showhide\" *ngIf=\"formLayout.sectionExpandable && formLayout.sectionExpandable.allowed && formLayout.sectionExpandable.default == 'EXPAND'\" matListIcon>keyboard_arrow_up</mat-icon>\n          </span>\n          \n        </mat-list-item>\n        <mat-divider class=\"mx-form-section-divider\" *ngIf=\"formLayout.sectionLabel && ((!formLayout.sectionExpandable || !formLayout.sectionExpandable.allowed) || (formLayout.sectionExpandable && formLayout.sectionExpandable.allowed && formLayout.sectionExpandable.default == 'EXPAND'))\"></mat-divider>\n        <div class=\"mdc-layout-grid mx-form-field-container\" [hidden]=\"formLayout.sectionExpandable && formLayout.sectionExpandable.allowed && formLayout.sectionExpandable.default == 'COLLAPSE'\">\n          <!-- <pre>{{formLayout | json}}</pre> -->\n          <div class=\"mdc-layout-grid__inner\" *ngFor=\"let row of formLayout.rows; let rIndex = index;\">\n            <div class=\"mdc-layout-grid__cell--span-{{cellCount / formConfig.displayInColumns * (column.displayInColumns ? column.displayInColumns : 1)}} mdc-layout-grid__cell--align-top\" *ngFor=\"let column of row.columns\">\n              <!-- <pre>\n                {{column | json}}\n                {{form.controls[column.field.key]}}\n              </pre> -->\n              <ng-container \n                [ngTemplateOutlet]=\"cfControl\"\n                [ngTemplateOutletContext]=\"{formField: column}\"\n              ></ng-container>\n            </div>\n          </div>\n        </div> \n      </mat-list>\n    </div>\n  </mat-card-content>\n  <!-- <pre>{{originalData | json}}</pre> -->\n\n  <mat-card-content class=\"mx-card-mobile\" *ngIf=\"formConfig.showCustomLayout\">\n    <mat-grid-list \n      [cols]=\"formConfig.layout.cellCount\"  \n      [rowHeight]=\"formConfig.layout.rowHeight\">\n      <mat-grid-tile\n        *ngFor=\"let cell of formConfig.layout.cells\"\n        [colspan]=\"cell.cols\"\n        [rowspan]=\"cell.rows\">\n        <span class=\"mx-card-mobile-cell-container\" *ngIf=\"cell.controls && cell.controls.length > 0; else elseValue;\">\n          <div class=\"mx-card-mobile-cell-inline\" *ngIf=\"cell.displayInline && cell.displayInline.separator; else elseValue;\"> \n            <ng-container \n              [ngTemplateOutlet]=\"cfCustomCell\"\n              [ngTemplateOutletContext]=\"{cell:cell}\"\n            ></ng-container>\n          </div>\n          <ng-template #elseValue>\n            <div class=\"mx-card-mobile-cell\">\n              <ng-container  \n                [ngTemplateOutlet]=\"cfCustomCell\"\n                [ngTemplateOutletContext]=\"{cell:cell}\"\n              ></ng-container>\n            </div>\n          </ng-template>\n        </span>\n        <ng-template #elseValue>\n          <span\n            *ngIf=\"cell.separator && (cell.separator.label || cell.separator.icon)\" \n            class=\"mx-form-separator\" \n          >\n            <mat-icon *ngIf=\"cell.separator.icon\" matListIcon>{{ cell.separator.icon }}</mat-icon>\n            <span>{{cell.separator.label}}</span>\n          </span>\n        </ng-template>\n    </mat-grid-tile>\n    </mat-grid-list>   \n  </mat-card-content>\n\n  <mat-card-actions \n    class=\"mx-form-action\"  \n    [style.text-align]=\"formButton.align\"\n    *ngIf=\"formButton && showButtons\">\n    <mx-button-group \n      [buttons]=\"formButton.buttons\" \n      [form]=\"form\" \n      [formDisplayMode]=\"formConfig.displayMode\"\n      [sourceIdentifier]=\"formConfig.identifier\"\n      [sourceIndex]=\"sourceIndex\" \n      [widgetArrayIndex]=\"widgetArrayIndex\"\n      [originalData]=\"originalData\"\n      [context]=\"getFormValue()\" \n      (onClick)=\"buttonClick($event)\"> \n    </mx-button-group>\n  </mat-card-actions> \n\n  <mat-card-actions  \n    class=\"mx-form-action\"  \n    *ngIf=\"formButtonLayout && showButtons\">\n    <mat-grid-list \n      [cols]=\"cellCount\"  \n      [rowHeight]=\"formButtonLayout.rowHeight\">\n      <mat-grid-tile\n        *ngFor=\"let cell of formButtonLayout.cells\"\n        [colspan]=\"cell.cols\"\n        [rowspan]=\"cell.rows\"> \n        <div \n          [ngClass]=\"{'mx-form-button-grid-cell-left': cell.buttons.align == 'left', 'mx-form-button-grid-cell-right': cell.buttons.align == 'right', 'mx-form-button-grid-cell-center': cell.buttons.align == 'center'}\">\n          <mx-button-group \n            *ngIf=\"cell && cell.buttons && cell.buttons.buttons\"\n            [buttons]=\"cell.buttons.buttons\" \n            [form]=\"form\" \n            [formDisplayMode]=\"formConfig.displayMode\"\n            [sourceIdentifier]=\"formConfig.identifier\"\n            [sourceIndex]=\"sourceIndex\" \n            [widgetArrayIndex]=\"widgetArrayIndex\"\n            [originalData]=\"originalData\"\n            [context]=\"getFormValue()\" \n            (onClick)=\"buttonClick($event)\">\n          </mx-button-group>\n        </div>\n      </mat-grid-tile>\n    </mat-grid-list>\n  </mat-card-actions> \n</mat-card>\n\n<ng-template #cfCustomCell let-cell=\"cell\"> \n  <span \n    [ngClass]=\"{'fullwidth': control.fullWidth}\"\n    *ngFor=\"let control of cell.controls; let cControlIndex = index;\">\n    <!-- {{control.control.key}} --> \n    <span \n      class=\"mx-card-mobile-control-separator\"\n      *ngIf=\"cell.displayInline && cell.displayInline.separator && cControlIndex > 0\" \n      [innerHtml]=\"cell.displayInline.separator\"></span>\n\n      <!-- =={{cell.link | json}}--{{cell.linkKey}}--=={{control.control.key}}=={{control.type}}== -->\n      <!-- //{{control.colIndex}}-{{control.cControlIndex}} -->\n      <ng-container \n        *ngIf=\"control.type == 'FIELD'\"\n        [ngTemplateOutlet]=\"cfControl\"\n        [ngTemplateOutletContext]=\"{formField: control.control}\"\n      ></ng-container>\n  </span>\n</ng-template>\n\n<ng-template #cfControl let-formField=\"formField\">\n  <mx-field \n    *ngIf=\"formField && !formField.addMore\"\n    [sourceType]=\"'FORM'\"\n    [sourceIdentifier]=\"formConfig.identifier\" \n    [sourceIndex]=\"sourceIndex\" \n    [widgetArrayIndex]=\"widgetArrayIndex\"\n    [form]=\"form\" \n    [keyMap]=\"keyMap\"\n    [fieldControl]=\"form.controls[formField.field.key]\"\n    [field]=\"formField.field\"\n    [originalData]=\"originalData\"\n    [displayMode]=\"formConfig.displayMode\" \n    [value]=\"\" \n    [dependencies]=\"dependencies\"\n    (onDependentFieldChange)=\"dependentFieldChange($event)\"\n    (onFieldChange)=\"fieldChange($event)\"\n    (onButtonClick)=\"buttonClick($event)\"\n    class=\"mx-form-field\">\n  </mx-field>\n  <ng-template [ngIf]=\"formField && formField.addMore\">\n    <span *ngFor=\"let fieldControl of form.controls[formField.field.key]['controls']; let i=index;\">\n      <mx-field\n        [sourceType]=\"'FORM'\"\n        [sourceIdentifier]=\"formConfig.identifier\" \n        [sourceIndex]=\"sourceIndex\" \n        [widgetArrayIndex]=\"widgetArrayIndex\"\n        [fieldIndex]=\"i\"\n        [form]=\"form\" \n        [keyMap]=\"keyMap\"\n        [fieldControl]=\"fieldControl\"\n        [field]=\"formField.field\"\n        [originalData]=\"originalData\"\n        [displayMode]=\"formConfig.displayMode\" \n        [value]=\"\" \n        [isAddMore]=\"formField.addMore\"\n        [addMorePermission]=\"formField.addMorePermission\"\n        [device]=\"isDesktop ? 'desktop' : (isTablet ? 'tablet' : 'mobile')\"\n        [displayInColumns]=\"cellCount / formConfig.displayInColumns * (formField.displayInColumns ? formField.displayInColumns : 1)\"\n        [dependencies]=\"dependencies\"\n        (onDependentFieldChange)=\"dependentFieldChange($event)\"\n        (onFieldChange)=\"fieldChange($event)\"\n        (onButtonClick)=\"buttonClick($event)\"\n        class=\"mx-form-field\">\n      </mx-field>\n    </span>\n  </ng-template>\n</ng-template>\n\n",
                encapsulation: ViewEncapsulation.None,
                styles: [":root{--mdc-layout-grid-column-width-desktop:72px;--mdc-layout-grid-column-width-phone:72px;--mdc-layout-grid-column-width-tablet:72px;--mdc-layout-grid-gutter-desktop:24px;--mdc-layout-grid-gutter-phone:16px;--mdc-layout-grid-gutter-tablet:16px;--mdc-layout-grid-margin-desktop:24px;--mdc-layout-grid-margin-phone:16px;--mdc-layout-grid-margin-tablet:16px}@media (min-width:840px){.mdc-layout-grid{box-sizing:border-box;margin:0 auto;padding:24px;padding:var(--mdc-layout-grid-margin-desktop,24px)}}@media (min-width:600px) and (max-width:839px){.mdc-layout-grid{box-sizing:border-box;margin:0 auto;padding:16px;padding:var(--mdc-layout-grid-margin-tablet,16px)}}@media (max-width:599px){.mdc-layout-grid{box-sizing:border-box;margin:0 auto;padding:16px;padding:var(--mdc-layout-grid-margin-phone,16px)}}@media (min-width:840px){.mdc-layout-grid__inner{align-items:stretch;display:flex;flex-flow:row wrap;margin:-12px;margin:calc(var(--mdc-layout-grid-gutter-desktop, 24px)/2*-1)}@supports (display:grid){.mdc-layout-grid__inner{-ms-grid-columns:(minmax(0,1fr))[12];display:-ms-grid;display:grid;grid-gap:24px;grid-gap:var(--mdc-layout-grid-gutter-desktop,24px);grid-template-columns:repeat(12,minmax(0,1fr));margin:0}}}@media (min-width:600px) and (max-width:839px){.mdc-layout-grid__inner{align-items:stretch;display:flex;flex-flow:row wrap;margin:-8px;margin:calc(var(--mdc-layout-grid-gutter-tablet, 16px)/2*-1)}@supports (display:grid){.mdc-layout-grid__inner{-ms-grid-columns:(minmax(0,1fr))[8];display:-ms-grid;display:grid;grid-gap:16px;grid-gap:var(--mdc-layout-grid-gutter-tablet,16px);grid-template-columns:repeat(8,minmax(0,1fr));margin:0}}}@media (max-width:599px){.mdc-layout-grid__inner{align-items:stretch;display:flex;flex-flow:row wrap;margin:-8px;margin:calc(var(--mdc-layout-grid-gutter-phone, 16px)/2*-1)}@supports (display:grid){.mdc-layout-grid__inner{-ms-grid-columns:(minmax(0,1fr))[4];display:-ms-grid;display:grid;grid-gap:16px;grid-gap:var(--mdc-layout-grid-gutter-phone,16px);grid-template-columns:repeat(4,minmax(0,1fr));margin:0}}}@media (min-width:840px){.mdc-layout-grid__cell{box-sizing:border-box;margin:12px;margin:calc(var(--mdc-layout-grid-gutter-desktop, 24px)/2);width:calc(33.33333% - 24px);width:calc(33.33333% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell{-ms-grid-column-span:4;grid-column-end:span 4;margin:0;width:auto}}.mdc-layout-grid__cell--span-1,.mdc-layout-grid__cell--span-1-desktop{width:calc(8.33333% - 24px);width:calc(8.33333% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-1,.mdc-layout-grid__cell--span-1-desktop{-ms-grid-column-span:1;grid-column-end:span 1;width:auto}}.mdc-layout-grid__cell--span-2,.mdc-layout-grid__cell--span-2-desktop{width:calc(16.66667% - 24px);width:calc(16.66667% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-2,.mdc-layout-grid__cell--span-2-desktop{-ms-grid-column-span:2;grid-column-end:span 2;width:auto}}.mdc-layout-grid__cell--span-3,.mdc-layout-grid__cell--span-3-desktop{width:calc(25% - 24px);width:calc(25% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-3,.mdc-layout-grid__cell--span-3-desktop{-ms-grid-column-span:3;grid-column-end:span 3;width:auto}}.mdc-layout-grid__cell--span-4,.mdc-layout-grid__cell--span-4-desktop{width:calc(33.33333% - 24px);width:calc(33.33333% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-4,.mdc-layout-grid__cell--span-4-desktop{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-5,.mdc-layout-grid__cell--span-5-desktop{width:calc(41.66667% - 24px);width:calc(41.66667% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-5,.mdc-layout-grid__cell--span-5-desktop{-ms-grid-column-span:5;grid-column-end:span 5;width:auto}}.mdc-layout-grid__cell--span-6,.mdc-layout-grid__cell--span-6-desktop{width:calc(50% - 24px);width:calc(50% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-6,.mdc-layout-grid__cell--span-6-desktop{-ms-grid-column-span:6;grid-column-end:span 6;width:auto}}.mdc-layout-grid__cell--span-7,.mdc-layout-grid__cell--span-7-desktop{width:calc(58.33333% - 24px);width:calc(58.33333% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-7,.mdc-layout-grid__cell--span-7-desktop{-ms-grid-column-span:7;grid-column-end:span 7;width:auto}}.mdc-layout-grid__cell--span-8,.mdc-layout-grid__cell--span-8-desktop{width:calc(66.66667% - 24px);width:calc(66.66667% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-8,.mdc-layout-grid__cell--span-8-desktop{-ms-grid-column-span:8;grid-column-end:span 8;width:auto}}.mdc-layout-grid__cell--span-9,.mdc-layout-grid__cell--span-9-desktop{width:calc(75% - 24px);width:calc(75% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-9,.mdc-layout-grid__cell--span-9-desktop{-ms-grid-column-span:9;grid-column-end:span 9;width:auto}}.mdc-layout-grid__cell--span-10,.mdc-layout-grid__cell--span-10-desktop{width:calc(83.33333% - 24px);width:calc(83.33333% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-10,.mdc-layout-grid__cell--span-10-desktop{-ms-grid-column-span:10;grid-column-end:span 10;width:auto}}.mdc-layout-grid__cell--span-11,.mdc-layout-grid__cell--span-11-desktop{width:calc(91.66667% - 24px);width:calc(91.66667% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-11,.mdc-layout-grid__cell--span-11-desktop{-ms-grid-column-span:11;grid-column-end:span 11;width:auto}}.mdc-layout-grid__cell--span-12,.mdc-layout-grid__cell--span-12-desktop{width:calc(100% - 24px);width:calc(100% - var(--mdc-layout-grid-gutter-desktop, 24px))}@supports (display:grid){.mdc-layout-grid__cell--span-12,.mdc-layout-grid__cell--span-12-desktop{-ms-grid-column-span:12;grid-column-end:span 12;width:auto}}}@media (min-width:600px) and (max-width:839px){.mdc-layout-grid__cell{box-sizing:border-box;margin:8px;margin:calc(var(--mdc-layout-grid-gutter-tablet, 16px)/2);width:calc(50% - 16px);width:calc(50% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell{-ms-grid-column-span:4;grid-column-end:span 4;margin:0;width:auto}}.mdc-layout-grid__cell--span-1,.mdc-layout-grid__cell--span-1-tablet{width:calc(12.5% - 16px);width:calc(12.5% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-1,.mdc-layout-grid__cell--span-1-tablet{-ms-grid-column-span:1;grid-column-end:span 1;width:auto}}.mdc-layout-grid__cell--span-2,.mdc-layout-grid__cell--span-2-tablet{width:calc(25% - 16px);width:calc(25% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-2,.mdc-layout-grid__cell--span-2-tablet{-ms-grid-column-span:2;grid-column-end:span 2;width:auto}}.mdc-layout-grid__cell--span-3,.mdc-layout-grid__cell--span-3-tablet{width:calc(37.5% - 16px);width:calc(37.5% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-3,.mdc-layout-grid__cell--span-3-tablet{-ms-grid-column-span:3;grid-column-end:span 3;width:auto}}.mdc-layout-grid__cell--span-4,.mdc-layout-grid__cell--span-4-tablet{width:calc(50% - 16px);width:calc(50% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-4,.mdc-layout-grid__cell--span-4-tablet{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-5,.mdc-layout-grid__cell--span-5-tablet{width:calc(62.5% - 16px);width:calc(62.5% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-5,.mdc-layout-grid__cell--span-5-tablet{-ms-grid-column-span:5;grid-column-end:span 5;width:auto}}.mdc-layout-grid__cell--span-6,.mdc-layout-grid__cell--span-6-tablet{width:calc(75% - 16px);width:calc(75% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-6,.mdc-layout-grid__cell--span-6-tablet{-ms-grid-column-span:6;grid-column-end:span 6;width:auto}}.mdc-layout-grid__cell--span-7,.mdc-layout-grid__cell--span-7-tablet{width:calc(87.5% - 16px);width:calc(87.5% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-7,.mdc-layout-grid__cell--span-7-tablet{-ms-grid-column-span:7;grid-column-end:span 7;width:auto}}.mdc-layout-grid__cell--span-8,.mdc-layout-grid__cell--span-8-tablet{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-8,.mdc-layout-grid__cell--span-8-tablet{-ms-grid-column-span:8;grid-column-end:span 8;width:auto}}.mdc-layout-grid__cell--span-9,.mdc-layout-grid__cell--span-9-tablet{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-9,.mdc-layout-grid__cell--span-9-tablet{-ms-grid-column-span:8;grid-column-end:span 8;width:auto}}.mdc-layout-grid__cell--span-10,.mdc-layout-grid__cell--span-10-tablet{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-10,.mdc-layout-grid__cell--span-10-tablet{-ms-grid-column-span:8;grid-column-end:span 8;width:auto}}.mdc-layout-grid__cell--span-11,.mdc-layout-grid__cell--span-11-tablet{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-11,.mdc-layout-grid__cell--span-11-tablet{-ms-grid-column-span:8;grid-column-end:span 8;width:auto}}.mdc-layout-grid__cell--span-12,.mdc-layout-grid__cell--span-12-tablet{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-tablet, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-12,.mdc-layout-grid__cell--span-12-tablet{-ms-grid-column-span:8;grid-column-end:span 8;width:auto}}}@media (max-width:599px){.mdc-layout-grid__cell{box-sizing:border-box;margin:8px;margin:calc(var(--mdc-layout-grid-gutter-phone, 16px)/2);width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell{-ms-grid-column-span:4;grid-column-end:span 4;margin:0;width:auto}}.mdc-layout-grid__cell--span-1,.mdc-layout-grid__cell--span-1-phone{width:calc(25% - 16px);width:calc(25% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-1,.mdc-layout-grid__cell--span-1-phone{-ms-grid-column-span:1;grid-column-end:span 1;width:auto}}.mdc-layout-grid__cell--span-2,.mdc-layout-grid__cell--span-2-phone{width:calc(50% - 16px);width:calc(50% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-2,.mdc-layout-grid__cell--span-2-phone{-ms-grid-column-span:2;grid-column-end:span 2;width:auto}}.mdc-layout-grid__cell--span-3,.mdc-layout-grid__cell--span-3-phone{width:calc(75% - 16px);width:calc(75% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-3,.mdc-layout-grid__cell--span-3-phone{-ms-grid-column-span:3;grid-column-end:span 3;width:auto}}.mdc-layout-grid__cell--span-4,.mdc-layout-grid__cell--span-4-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-4,.mdc-layout-grid__cell--span-4-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-5,.mdc-layout-grid__cell--span-5-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-5,.mdc-layout-grid__cell--span-5-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-6,.mdc-layout-grid__cell--span-6-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-6,.mdc-layout-grid__cell--span-6-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-7,.mdc-layout-grid__cell--span-7-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-7,.mdc-layout-grid__cell--span-7-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-8,.mdc-layout-grid__cell--span-8-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-8,.mdc-layout-grid__cell--span-8-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-9,.mdc-layout-grid__cell--span-9-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-9,.mdc-layout-grid__cell--span-9-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-10,.mdc-layout-grid__cell--span-10-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-10,.mdc-layout-grid__cell--span-10-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-11,.mdc-layout-grid__cell--span-11-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-11,.mdc-layout-grid__cell--span-11-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}.mdc-layout-grid__cell--span-12,.mdc-layout-grid__cell--span-12-phone{width:calc(100% - 16px);width:calc(100% - var(--mdc-layout-grid-gutter-phone, 16px))}@supports (display:grid){.mdc-layout-grid__cell--span-12,.mdc-layout-grid__cell--span-12-phone{-ms-grid-column-span:4;grid-column-end:span 4;width:auto}}}.mdc-layout-grid__cell--order-1{order:1}.mdc-layout-grid__cell--order-2{order:2}.mdc-layout-grid__cell--order-3{order:3}.mdc-layout-grid__cell--order-4{order:4}.mdc-layout-grid__cell--order-5{order:5}.mdc-layout-grid__cell--order-6{order:6}.mdc-layout-grid__cell--order-7{order:7}.mdc-layout-grid__cell--order-8{order:8}.mdc-layout-grid__cell--order-9{order:9}.mdc-layout-grid__cell--order-10{order:10}.mdc-layout-grid__cell--order-11{order:11}.mdc-layout-grid__cell--order-12{order:12}.mdc-layout-grid__cell--align-top{align-self:flex-start}@supports (display:grid){.mdc-layout-grid__cell--align-top{-ms-grid-row-align:start;align-self:start}}.mdc-layout-grid__cell--align-middle{-ms-grid-row-align:center;align-self:center}.mdc-layout-grid__cell--align-bottom{align-self:flex-end}@supports (display:grid){.mdc-layout-grid__cell--align-bottom{-ms-grid-row-align:end;align-self:end}}@media (min-width:840px){.mdc-layout-grid--fixed-column-width{width:1176px;width:calc(var(--mdc-layout-grid-column-width-desktop, 72px)*12 + var(--mdc-layout-grid-gutter-desktop, 24px)*11 + var(--mdc-layout-grid-margin-desktop, 24px)*2)}}@media (min-width:600px) and (max-width:839px){.mdc-layout-grid--fixed-column-width{width:720px;width:calc(var(--mdc-layout-grid-column-width-tablet, 72px)*8 + var(--mdc-layout-grid-gutter-tablet, 16px)*7 + var(--mdc-layout-grid-margin-tablet, 16px)*2)}}@media (max-width:599px){.mdc-layout-grid--fixed-column-width{width:368px;width:calc(var(--mdc-layout-grid-column-width-phone, 72px)*4 + var(--mdc-layout-grid-gutter-phone, 16px)*3 + var(--mdc-layout-grid-margin-phone, 16px)*2)}}.mdc-layout-grid--align-left{margin-left:0;margin-right:auto}.mdc-layout-grid--align-right{margin-left:auto;margin-right:0}body{margin:0}.mx-form-container{box-shadow:none!important}.mx-form-field{width:100%}.mx-form-separator{font-size:12px}.mx-form-separator .mat-list-item-content{padding-left:0!important}.mdc-layout-grid{padding:0!important}.mat-card-header-text{margin:0}.mx-form-header-desc{padding:5px 10px;width:auto}.mx-form-header-desc-icon{font-size:15px;height:15px!important;margin-top:0;padding:0 5px 0 0;width:15px!important}.mat-card-subtitle{padding-top:12px}.mx-form-field-container{padding-top:8px!important}.fields-container .mat-list-base{padding-top:0!important}.mx-form-separator-expandable{color:#00f!important;cursor:pointer;text-decoration:underline}.mx-form-section-showhide{font-size:16px!important;height:16px!important;width:16px!important}.mx-form-button-grid-cell-left{bottom:8px;left:8px;position:absolute}.mx-form-button-grid-cell-right{bottom:8px;position:absolute;right:8px}.mx-form-section-divider{border-top-color:#696969;border-top-width:2px!important}::-webkit-scrollbar{height:8px;width:8px}::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 4px rgba(0,0,0,.38);border-radius:2px}::-webkit-scrollbar-thumb{-webkit-box-shadow:inset 0 0 2px rgba(0,0,0,.5);border-radius:8px}::-webkit-scrollbar-thumb,::-webkit-scrollbar-thumb:window-inactive{background:rgba(0,0,0,.38)}.mx-card-mobile{margin-bottom:12px;word-wrap:break-word}.mx-card-mobile .mat-grid-tile .mat-figure{justify-content:unset}.mx-card-mobile .mx-primary-text .mx-field-value{font-size:18px;font-weight:400;margin-bottom:none}.mx-card-mobile .mx-secondary-text .mx-field-value{font-size:14px;font-weight:300;margin-bottom:none;margin-top:4px}.mx-card-mobile .mx-tertiary-text .mx-field-value{font-size:12px;font-weight:300;margin-bottom:none;margin-top:8px}.mx-card-mobile .mx-card-mobile-cell-container{width:100%}.mx-card-mobile .mx-card-mobile-cell{display:block;padding:4px;width:100%}.mx-card-mobile .mx-card-mobile-cell .fullwidth button{width:100%}.mx-card-mobile .mx-card-mobile-cell .mx-primary-text .mx-field-value,.mx-card-mobile .mx-card-mobile-cell .mx-secondary-text .mx-field-value,.mx-card-mobile .mx-card-mobile-cell .mx-tertiary-text .mx-field-value{display:block}.mx-card-mobile .mx-card-mobile-cell .fullwidth button,.mx-card-mobile .mx-card-mobile-cell .fullwidth mat-chip{width:100%}.mx-card-mobile .mx-card-mobile-cell-inline{display:inline-block;padding:4px;width:100%}.mx-card-mobile .mx-card-mobile-cell-inline .mx-card-mobile-control-separator{padding:4px}.mx-card-mobile .mx-card-mobile-cell-inline .mx-field-lbl-for-label{display:inherit}"]
            },] }
];
FormComponent.ctorParameters = () => [
    { type: Ability },
    { type: BreakpointObserver }
];
FormComponent.propDecorators = {
    _formConfig: [{ type: Input }],
    formConfig: [{ type: Input }],
    sourceIdentifier: [{ type: Input }],
    sourceIndex: [{ type: Input }],
    widgetArrayIndex: [{ type: Input }],
    originalData: [{ type: Input }],
    keyMap: [{ type: Input }],
    onFormChange: [{ type: Output }],
    onFieldChange: [{ type: Output }],
    onButtonClick: [{ type: Output }],
    supportingRecord: [{ type: Input }],
    record: [{ type: Input }],
    reset: [{ type: Input }],
    form: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL25pdGlua2hhaXRhbi9OaXRpbi9zdHVkeS9hbmd1bGFyL21hdGVyaWFsL2FkbWluLWJ1aWxkZXItcGx1Z2luL3Byb2plY3RzL25neC1tYXRlcmlhbC13aWRnZXQvc3JjLyIsInNvdXJjZXMiOlsibGliL2Zvcm0vY29tcG9uZW50L2Zvcm0vZm9ybS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBcUIsS0FBSyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFN0csT0FBTyxFQUFFLGtCQUFrQixFQUFFLFdBQVcsRUFBbUIsTUFBTSxxQkFBcUIsQ0FBQztBQU12RixPQUFPLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDdEksT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQ2hFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFTeEMsTUFBTSxPQUFPLGFBQWE7SUFxRnhCLGlDQUFpQztJQUVqQywwQ0FBMEM7SUFFMUMsWUFBb0IsT0FBZ0IsRUFBVSxrQkFBc0M7UUFBaEUsWUFBTyxHQUFQLE9BQU8sQ0FBUztRQUFVLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBb0I7UUFoRTFFLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsQyxrQkFBYSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDbkMsa0JBQWEsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRTdDLGVBQVUsR0FBcUIsSUFBSSxLQUFLLEVBQWEsQ0FBQztRQUd0RCxjQUFTLEdBQVcsRUFBRSxDQUFDO1FBSXZCLGdCQUFXLEdBQVksSUFBSSxDQUFD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Z0JBQ1QsUUFBUSxFQUFFLFNBQVM7Z0JBQ25CLGk2VkFBb0M7Z0JBRXBDLGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJOzthQUN0Qzs7O1lBUlEsT0FBTztZQVJQLGtCQUFrQjs7OzBCQWtCeEIsS0FBSzt5QkFJTCxLQUFLOytCQWVMLEtBQUs7MEJBQ0wsS0FBSzsrQkFDTCxLQUFLOzJCQUNMLEtBQUs7cUJBQ0wsS0FBSzsyQkFDTCxNQUFNOzRCQUNOLE1BQU07NEJBQ04sTUFBTTsrQkFlTixLQUFLO3FCQVdMLEtBQUs7b0JBY0wsS0FBSzttQkFTTCxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIE9uRGVzdHJveSwgSW5wdXQsIEV2ZW50RW1pdHRlciwgT3V0cHV0LCBWaWV3RW5jYXBzdWxhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBCcmVha3BvaW50T2JzZXJ2ZXIsIEJyZWFrcG9pbnRzLCBCcmVha3BvaW50U3RhdGUgfSBmcm9tICdAYW5ndWxhci9jZGsvbGF5b3V0JztcblxuaW1wb3J0IHsgRm9ybSwgRm9ybURpYXBseU1vZGUsIEZvcm1GaWVsZCwgRm9ybUxheW91dCwgRm9ybUxheW91dFJvdywgRm9ybVNlY3Rpb25FeHBhbmQsIEZvcm1CdXR0b24sIEZvcm1CdXR0b25MYXlvdXQgfSBmcm9tICcuLi8uLi9tb2RlbCc7XG5pbXBvcnQgeyBGaWVsZCwgRmllbGRDaGFuZ2UsIEtleU1hcCwgS2V5TWFwT3B0aW9uVHlwZSB9IGZyb20gJy4uLy4uLy4uL2ZpZWxkL21vZGVsJztcbmltcG9ydCB7IEZvcm1Hcm91cCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gJy4uLy4uLy4uL2J1dHRvbi9tb2RlbCc7XG5pbXBvcnQgeyBGb3JtVXRpbHMsIE9iamVjdFV0aWxzLCBLZXlNYXBVdGlscywgQnV0dG9uVXRpbHMsIENvbGxlY3Rpb25VdGlscywgRm9ybUN1c3RvbVV0aWxzLCBEZXBlbmRlbnRVdGlscyB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdHknO1xuaW1wb3J0IHsgQWJpbGl0eVV0aWxzIH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS9hYmlsaXR5LnV0aWxpdHknO1xuaW1wb3J0IHsgQWJpbGl0eSB9IGZyb20gJ0BjYXNsL2FiaWxpdHknO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ214LWZvcm0nLCBcbiAgdGVtcGxhdGVVcmw6ICcuL2Zvcm0uY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9mb3JtLmNvbXBvbmVudC5zY3NzJ10sXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmVcbn0pXG5leHBvcnQgY2xhc3MgRm9ybUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgQElucHV0KCkgX2Zvcm1Db25maWc6IEZvcm07XG4gIGdldCBmb3JtQ29uZmlnKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1Db25maWc7XG4gIH1cbiAgQElucHV0KClcbiAgc2V0IGZvcm1Db25maWcoX2Zvcm1Db25maWc6IGFueSkge1xuICAgIHRoaXMuX2Zvcm1Db25maWcgPSBfZm9ybUNvbmZpZztcbiAgICAvLyB0aGlzLmhlYWRlclJlbG9hZCA9IGZhbHNlO1xuXG4gICAgd2hpbGUoMSkgIHtcbiAgICAgIGlmICh0aGlzLmZvcm1Jbml0aWFsaXplZCkge1xuICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLmhlYWRlclJlbG9hZCA9IHRydWU7fSwgMjApO1xuICAgICAgICBjb25zb2xlLmxvZyhcIjFcIik7XG4gICAgICAgIHRoaXMuaW5pdCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBASW5wdXQoKSBzb3VyY2VJZGVudGlmaWVyOiBzdHJpbmc7XG4gIEBJbnB1dCgpIHNvdXJjZUluZGV4OiBudW1iZXI7XG4gIEBJbnB1dCgpIHdpZGdldEFycmF5SW5kZXg6IG51bWJlcjtcbiAgQElucHV0KCkgb3JpZ2luYWxEYXRhOiBhbnk7XG4gIEBJbnB1dCgpIGtleU1hcDogQXJyYXk8S2V5TWFwPjsgXG4gIEBPdXRwdXQoKSBvbkZvcm1DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBvbkZpZWxkQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgb25CdXR0b25DbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICBmb3JtRmllbGRzOiBBcnJheTxGb3JtRmllbGQ+ID0gbmV3IEFycmF5PEZvcm1GaWVsZD4oKTtcbiAgZGVwZW5kZW5jaWVzOiBhbnk7XG5cbiAgY2VsbENvdW50OiBudW1iZXIgPSAxMjtcbiAgaXNNb2JpbGU6IGJvb2xlYW47XG4gIGlzVGFibGV0OiBib29sZWFuO1xuICBpc0Rlc2t0b3A6IGJvb2xlYW47XG4gIHNob3dCdXR0b25zOiBib29sZWFuID0gdHJ1ZTtcblxuICBwcml2YXRlIF9zdXBwb3J0aW5nUmVjb3JkOiBhbnk7XG4gIGdldCBzdXBwb3J0aW5nUmVjb3JkKCk6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuX3N1cHBvcnRpbmdSZWNvcmQ7XG4gIH1cbiAgQElucHV0KClcbiAgc2V0IHN1cHBvcnRpbmdSZWNvcmQoX3N1cHBvcnRpbmdSZWNvcmQ6IGFueSkge1xuICAgIHRoaXMuX3N1cHBvcnRpbmdSZWNvcmQgPSBfc3VwcG9ydGluZ1JlY29yZDtcblxuICAgIHRoaXMuaW5pdEZvcm1Hcm91cCgpO1xuICB9XG5cbiAgcHJpdmF0ZSBfcmVjb3JkOiBhbnk7XG4gIGdldCByZWNvcmQoKTogYW55IHtcbiAgICByZXR1cm4gdGhpcy5fcmVjb3JkO1xuICB9XG4gIEBJbnB1dCgpXG4gIHNldCByZWNvcmQoX3JlY29yZDogYW55KSB7XG4gICAgdGhpcy5fcmVjb3JkID0gX3JlY29yZDtcblxuICAgIGlmICh0aGlzLm9yaWdpbmFsRGF0YSkgeyB9IGVsc2UgIHtcbiAgICAgIHRoaXMub3JpZ2luYWxEYXRhID0gdGhpcy5fcmVjb3JkO1xuICAgIH1cbiAgICB0aGlzLmluaXRGb3JtR3JvdXAoKTtcbiAgfVxuXG4gIHByaXZhdGUgX3Jlc2V0OiBib29sZWFuO1xuICBnZXQgcmVzZXQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3Jlc2V0O1xuICB9XG4gIEBJbnB1dCgpXG4gIHNldCByZXNldChfcmVzZXQ6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9yZXNldCA9IF9yZXNldDtcblxuICAgIGlmICh0aGlzLl9yZXNldCA9PSB0cnVlKSB7XG4gICAgICBGb3JtVXRpbHMucmVzZXQodGhpcy5mb3JtLCB0aGlzLmZvcm1Db25maWcpO1xuICAgIH1cbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGZvcm06IEZvcm1Hcm91cDtcbiAgZm9ybUxheW91dHM6IEFycmF5PEZvcm1MYXlvdXQ+ID0gbmV3IEFycmF5PEZvcm1MYXlvdXQ+KCk7XG5cbiAgZm9ybUJ1dHRvbjogRm9ybUJ1dHRvbjtcbiAgZm9ybUJ1dHRvbkxheW91dDogRm9ybUJ1dHRvbkxheW91dDtcbiAgYnJlYWtwb2ludFN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIGZvcm1Jbml0aWFsaXplZDogYm9vbGVhbiA9IHRydWU7XG4gIC8vIGhlYWRlclJlbG9hZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8vICB1bmZsYXR0ZW4gPSByZXF1aXJlKCdmbGF0JykudW5mbGF0dGVuO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgYWJpbGl0eTogQWJpbGl0eSwgcHJpdmF0ZSBicmVha3BvaW50T2JzZXJ2ZXI6IEJyZWFrcG9pbnRPYnNlcnZlcikge1xuICAgIEFiaWxpdHlVdGlscy5zZXRBYmlsaXR5KHRoaXMuYWJpbGl0eSk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLmZvcm1Jbml0aWFsaXplZCA9IHRydWU7XG4gIH1cblxuICBpbml0KCkgIHtcbiAgICB0aGlzLmdldExheW91dCgpO1xuICAgIHRoaXMuZ2V0QWN0aW9ucygpO1xuICAgIC8vICAgIHRoaXMuZmllbGREZWZhdWx0U2V0dGluZygpO1xuICAgIHRoaXMuZGVwZW5kZW5jaWVzID0geyAuLi5EZXBlbmRlbnRVdGlscy5nZXREZXBlbmRlbmN5VHJlZSh0aGlzLmZvcm1Db25maWcuZm9ybUZpZWxkcyksIC4uLkRlcGVuZGVudFV0aWxzLmdldERlcGVuZGVuY3lUcmVlRm9yQnV0dG9uKHRoaXMuZm9ybUNvbmZpZy5hY3Rpb24pIH07XG5cbiAgICB0aGlzLmdldEN1c3RvbUxheW91dCgpO1xuICB9XG5cbiAgZ2V0Q3VzdG9tTGF5b3V0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZvcm1Db25maWcuc2hvd0N1c3RvbUxheW91dCkge1xuICAgICAgRm9ybUN1c3RvbVV0aWxzLnNldEN1c3RvbUxheW91dCh0aGlzLmZvcm1Db25maWcsIHRoaXMuZm9ybUNvbmZpZy5sYXlvdXQpOyAgXG4gICAgfSBlbHNlICB7XG4gICAgICB0aGlzLmZvcm1Db25maWcuc2hvd0N1c3RvbUxheW91dCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGdldEFjdGlvbnMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9ybUNvbmZpZyAmJiB0aGlzLmZvcm1Db25maWcuYWN0aW9uICYmICg8Rm9ybUJ1dHRvbj50aGlzLmZvcm1Db25maWcuYWN0aW9uKS5hbGlnbiAmJiAoPEZvcm1CdXR0b24+dGhpcy5mb3JtQ29uZmlnLmFjdGlvbikuYnV0dG9ucyAmJiAoPEZvcm1CdXR0b24+dGhpcy5mb3JtQ29uZmlnLmFjdGlvbikuYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmZvcm1CdXR0b24gPSAoPEZvcm1CdXR0b24+dGhpcy5mb3JtQ29uZmlnLmFjdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZm9ybUNvbmZpZyAmJiB0aGlzLmZvcm1Db25maWcuYWN0aW9uICYmICg8Rm9ybUJ1dHRvbkxheW91dD50aGlzLmZvcm1Db25maWcuYWN0aW9uKS5jZWxscyAmJiAoPEZvcm1CdXR0b25MYXlvdXQ+dGhpcy5mb3JtQ29uZmlnLmFjdGlvbikuY2VsbHMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5mb3JtQnV0dG9uTGF5b3V0ID0gKDxGb3JtQnV0dG9uTGF5b3V0PnRoaXMuZm9ybUNvbmZpZy5hY3Rpb24pO1xuICAgIH1cbiAgfVxuXG4gIGRlcGVuZGVudEZpZWxkQ2hhbmdlKGFjdGlvbjogQWN0aW9uKSB7XG4gICAgaWYgKHRoaXMuZm9ybUNvbmZpZy5pZGVudGlmaWVyID09IGFjdGlvbi5zb3VyY2VJZGVudGlmaWVyKSB7XG4gICAgICBsZXQgbmV3UmVjb3JkID0gT2JqZWN0VXRpbHMudW5mbGF0dGVuKHRoaXMuZm9ybS5nZXRSYXdWYWx1ZSgpKTtcbiAgICAgIHRoaXMucmVjb3JkID0geyAuLi50aGlzLnJlY29yZCwgLi4ubmV3UmVjb3JkIH07XG4gICAgICBjb25zb2xlLmxvZyh0aGlzLnJlY29yZCk7XG4gICAgICB0aGlzLmluaXRGb3JtR3JvdXAoKTtcblxuICAgICAgdGhpcy5zaG93QnV0dG9ucyA9IGZhbHNlO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuc2hvd0J1dHRvbnMgPSB0cnVlO1xuICAgICAgfSwgNTApO1xuICAgIH1cbiAgfVxuXG4gIGZpZWxkQ2hhbmdlKGZpZWxkQ2hhbmdlOiBGaWVsZENoYW5nZSkge1xuICAgIHRoaXMub25GaWVsZENoYW5nZS5lbWl0KGZpZWxkQ2hhbmdlKTtcbiAgICB0aGlzLm9uRm9ybUNoYW5nZS5lbWl0KHRoaXMuZm9ybSk7XG4gIH1cblxuICBidXR0b25DbGljayhldmVudDogYW55KSB7XG4gICAgdGhpcy5vbkJ1dHRvbkNsaWNrLmVtaXQoZXZlbnQpO1xuICB9XG5cbiAgZmllbGREZWZhdWx0U2V0dGluZygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5mb3JtQ29uZmlnKSB7XG4gICAgICBmb3IgKGxldCBmb3JtRmllbGQgb2YgdGhpcy5mb3JtQ29uZmlnLmZvcm1GaWVsZHMpIHtcbiAgICAgICAgaWYgKCEoPEZpZWxkPmZvcm1GaWVsZC5maWVsZCkuZmllbGREaXNwbGF5VHlwZSkge1xuICAgICAgICAgICg8RmllbGQ+Zm9ybUZpZWxkLmZpZWxkKS5maWVsZERpc3BsYXlUeXBlID0gdGhpcy5mb3JtQ29uZmlnLmRpc3BsYXlUeXBlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5mb3JtQ29uZmlnLmRpc3BsYXlJbkNvbHVtbnMpIHtcbiAgICAgICAgdGhpcy5mb3JtQ29uZmlnLmRpc3BsYXlJbkNvbHVtbnMgPSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2V0VGl0bGUoKTtcbiAgfVxuXG4gIHNldFRpdGxlKCkge1xuICAgIGlmICh0aGlzLmZvcm1Db25maWcuaGVhZGVyKSB7XG4gICAgICBsZXQgdGl0bGUgPSB0aGlzLmZvcm1Db25maWcuaGVhZGVyLnRpdGxlO1xuICAgICAgc3dpdGNoICh0aGlzLmZvcm1Db25maWcuZGlzcGxheU1vZGUpIHtcbiAgICAgICAgY2FzZSBGb3JtRGlhcGx5TW9kZS5BREQ6XG4gICAgICAgICAgaWYgKHRoaXMuZm9ybUNvbmZpZy5oZWFkZXIuYWRkTW9kZVRpdGxlKSB7XG4gICAgICAgICAgICB0aXRsZSA9IHRoaXMuZm9ybUNvbmZpZy5oZWFkZXIuYWRkTW9kZVRpdGxlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGb3JtRGlhcGx5TW9kZS5FRElUOlxuICAgICAgICAgIGlmICh0aGlzLmZvcm1Db25maWcuaGVhZGVyLmVkaXRNb2RlVGl0bGUpIHtcbiAgICAgICAgICAgIHRpdGxlID0gdGhpcy5mb3JtQ29uZmlnLmhlYWRlci5lZGl0TW9kZVRpdGxlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGb3JtRGlhcGx5TW9kZS5WSUVXOlxuICAgICAgICAgIGlmICh0aGlzLmZvcm1Db25maWcuaGVhZGVyLnZpZXdNb2RlVGl0bGUpIHtcbiAgICAgICAgICAgIHRpdGxlID0gdGhpcy5mb3JtQ29uZmlnLmhlYWRlci52aWV3TW9kZVRpdGxlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBGb3JtRGlhcGx5TW9kZS5CTE9DS0VEOlxuICAgICAgICAgIGlmICh0aGlzLmZvcm1Db25maWcuaGVhZGVyLnZpZXdNb2RlVGl0bGUpIHtcbiAgICAgICAgICAgIHRpdGxlID0gdGhpcy5mb3JtQ29uZmlnLmhlYWRlci52aWV3TW9kZVRpdGxlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHRoaXMuZm9ybUNvbmZpZy5oZWFkZXIudGl0bGUgPSB0aXRsZTtcbiAgICB9XG4gIH1cblxuICBpbml0Rm9ybUdyb3VwKCk6IHZvaWQge1xuICAgIEtleU1hcFV0aWxzLnNldE9wdGlvbnNzVXNpbmdWYWx1ZXModGhpcy5rZXlNYXAsIGZhbHNlLCBLZXlNYXBPcHRpb25UeXBlLkZPUk0sIHRoaXMuZm9ybUNvbmZpZywgdGhpcy5fcmVjb3JkKTtcblxuICAgIHRoaXMuZm9ybSA9IEZvcm1VdGlscy5pbml0Rm9ybUdyb3VwKHRoaXMuZm9ybUNvbmZpZy5mb3JtRmllbGRzLCB0aGlzLl9zdXBwb3J0aW5nUmVjb3JkLCB0aGlzLl9yZWNvcmQsIHRoaXMuZm9ybUNvbmZpZy5kaXNwbGF5TW9kZSk7XG5cbiAgICB0aGlzLm9uRm9ybUNoYW5nZS5lbWl0KHRoaXMuZm9ybSk7XG5cbiAgICBpZiAodGhpcy5pc01vYmlsZSB8fCB0aGlzLmlzVGFibGV0IHx8IHRoaXMuaXNEZXNrdG9wKSB7XG4gICAgICB0aGlzLnJlc2V0RGlzcGxheUluQ29sdW1uKCk7XG4gICAgfVxuICB9XG5cbiAgLy8gaXNWYWxpZEJ1dHRvbihidXR0b246IEJ1dHRvbik6IGJvb2xlYW4ge1xuICAvLyAgIGxldCBpc1ZhbGlkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLy8gICBpZiAoYnV0dG9uLmRpc3BsYXlJbkZvcm1Nb2Rlcy5pbmRleE9mKHRoaXMuZm9ybUNvbmZpZy5kaXNwbGF5TW9kZSkgPiAtMSkge1xuICAvLyAgICAgaXNWYWxpZCA9IHRydWU7XG4gIC8vICAgfVxuICAvLyAgIHJldHVybiBpc1ZhbGlkO1xuICAvLyB9XG5cbiAgLy8gaXNOZXdSb3coaW5kZXg6IG51bWJlcik6IHN0cmluZyB7XG4gIC8vICAgbGV0IGRpc3BsYXlSb3c6IHN0cmluZyA9IFwiXCI7XG4gIC8vICAgaWYgKGluZGV4ICUgdGhpcy5mb3JtQ29uZmlnLmRpc3BsYXlJbkNvbHVtbnMgPT0gMCkge1xuICAvLyAgICAgZGlzcGxheVJvdyA9IFwicm93XCI7XG4gIC8vICAgfVxuXG4gIC8vICAgcmV0dXJuIGRpc3BsYXlSb3c7XG4gIC8vIH1cblxuICBnZXRGb3JtVmFsdWUoKTogYW55IHtcbiAgICByZXR1cm4gRm9ybVV0aWxzLmdldFJhd1ZhbHVlKHRoaXMuZm9ybSk7XG4gIH1cblxuICB0cmFuc2Zvcm1Sb3dzKCk6IHZvaWQge1xuICAgIGxldCBzZWN0aW9uTGFiZWw6IHN0cmluZyA9IFwiXCI7XG4gICAgbGV0IGZvcm1MYXlvdXRzOiBBcnJheTxGb3JtTGF5b3V0PiA9IG5ldyBBcnJheTxGb3JtTGF5b3V0PigpO1xuICAgIGxldCBpbmRleDogbnVtYmVyID0gLTE7XG5cbiAgICBsZXQgZGlzcGxheUluQ29sdW1ucyA9IHRoaXMuZm9ybUNvbmZpZy5kaXNwbGF5SW5Db2x1bW5zO1xuXG4gICAgaWYgKHRoaXMuZm9ybUNvbmZpZy5mb3JtRmllbGRzICYmIHRoaXMuZm9ybSkge1xuICAgICAgZm9yIChsZXQgZm9ybUZpZWxkIG9mIHRoaXMuZm9ybUNvbmZpZy5mb3JtRmllbGRzKSB7IFxuICAgICAgICBpZiAodGhpcy5mb3JtLmNvbnRyb2xzW2Zvcm1GaWVsZC5maWVsZC5rZXldICYmIERlcGVuZGVudFV0aWxzLmRpc3BsYXlEZXBlbmRlbmN5RmllbGQoZm9ybUZpZWxkLmZpZWxkLmRlcGVuZGVudE9uRmllbGRzLCB0aGlzLl9zdXBwb3J0aW5nUmVjb3JkLCB0aGlzLl9yZWNvcmQpKSB7XG4gICAgICAgICAgaWYgKGZvcm1GaWVsZC5zZXBhcmF0b3IgfHwgc2VjdGlvbkxhYmVsID09IFwiXCIpIHtcbiAgICAgICAgICAgIGZvcm1MYXlvdXRzLnB1c2goe1xuICAgICAgICAgICAgICBzZWN0aW9uTGFiZWw6IGZvcm1GaWVsZCAmJiBmb3JtRmllbGQuc2VwYXJhdG9yICYmIGZvcm1GaWVsZC5zZXBhcmF0b3IubGFiZWwgPyBmb3JtRmllbGQuc2VwYXJhdG9yLmxhYmVsIDogXCJcIixcbiAgICAgICAgICAgICAgc2VjdGlvbkljb246IGZvcm1GaWVsZCAmJiBmb3JtRmllbGQuc2VwYXJhdG9yICYmIGZvcm1GaWVsZC5zZXBhcmF0b3IuaWNvbiA/IGZvcm1GaWVsZC5zZXBhcmF0b3IuaWNvbiA6IFwiXCIsXG4gICAgICAgICAgICAgIHNlY3Rpb25FeHBhbmRhYmxlOiBmb3JtRmllbGQgJiYgZm9ybUZpZWxkLnNlcGFyYXRvciAmJiBmb3JtRmllbGQuc2VwYXJhdG9yLmV4cGFuZGFibGUgPyBmb3JtRmllbGQuc2VwYXJhdG9yLmV4cGFuZGFibGUgOiBudWxsLFxuICAgICAgICAgICAgICByb3dzOiBuZXcgQXJyYXk8Rm9ybUxheW91dFJvdz4oKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWN0aW9uTGFiZWwgPSBcIi1cIjtcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGZvcm1MYXlvdXRzW2luZGV4XSkge1xuICAgICAgICAgICAgbGV0IHJMZW5ndGggPSBmb3JtTGF5b3V0c1tpbmRleF0ucm93cy5sZW5ndGg7XG5cbiAgICAgICAgICAgIGlmIChmb3JtTGF5b3V0c1tpbmRleF0ucm93cy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICBmb3JtTGF5b3V0c1tpbmRleF0ucm93cy5wdXNoKHsgY29sdW1uczogbmV3IEFycmF5PEZvcm1GaWVsZD4oKSB9KTtcbiAgICAgICAgICAgICAgZm9ybUxheW91dHNbaW5kZXhdLnJvd3NbMF0uY29sdW1ucyA9IG5ldyBBcnJheTxGb3JtRmllbGQ+KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBjTGVuZ3RoID0gdGhpcy5mb3JtRmllbGRSb3dDb2x1bW5Db3VudChmb3JtTGF5b3V0cywgaW5kZXgpO1xuXG4gICAgICAgICAgICBpZiAoY0xlbmd0aCA+PSBkaXNwbGF5SW5Db2x1bW5zKSB7XG4gICAgICAgICAgICAgIGZvcm1MYXlvdXRzW2luZGV4XS5yb3dzW3JMZW5ndGhdID0geyBjb2x1bW5zOiBuZXcgQXJyYXk8Rm9ybUZpZWxkPigpIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvcm1MYXlvdXRzW2luZGV4XS5yb3dzW2Zvcm1MYXlvdXRzW2luZGV4XS5yb3dzLmxlbmd0aCAtIDFdLmNvbHVtbnMucHVzaChmb3JtRmllbGQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZm9ybUxheW91dHMgPSBmb3JtTGF5b3V0cztcbiAgfVxuXG4gIHByaXZhdGUgZm9ybUZpZWxkUm93Q29sdW1uQ291bnQoZm9ybUxheW91dHM6IEFycmF5PEZvcm1MYXlvdXQ+LCBpbmRleDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBsZXQgY29sQ291bnQgPSAwO1xuXG4gICAgZm9yIChsZXQgY0NudCA9IDA7IGNDbnQgPCBmb3JtTGF5b3V0c1tpbmRleF0ucm93c1tmb3JtTGF5b3V0c1tpbmRleF0ucm93cy5sZW5ndGggLSAxXS5jb2x1bW5zLmxlbmd0aDsgY0NudCsrKSB7XG4gICAgICBpZiAoZm9ybUxheW91dHNbaW5kZXhdLnJvd3NbZm9ybUxheW91dHNbaW5kZXhdLnJvd3MubGVuZ3RoIC0gMV0uY29sdW1uc1tjQ250XS5kaXNwbGF5SW5Db2x1bW5zKSB7XG4gICAgICAgIGNvbENvdW50ICs9IGZvcm1MYXlvdXRzW2luZGV4XS5yb3dzW2Zvcm1MYXlvdXRzW2luZGV4XS5yb3dzLmxlbmd0aCAtIDFdLmNvbHVtbnNbY0NudF0uZGlzcGxheUluQ29sdW1ucztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbENvdW50ICs9IDE7XG4gICAgICAgIGZvcm1MYXlvdXRzW2luZGV4XS5yb3dzW2Zvcm1MYXlvdXRzW2luZGV4XS5yb3dzLmxlbmd0aCAtIDFdLmNvbHVtbnNbY0NudF0uZGlzcGxheUluQ29sdW1ucyA9IDE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbENvdW50O1xuICB9XG5cbiAgdG9nZ2xlTGlzdChmb3JtTGF5b3V0OiBGb3JtTGF5b3V0KTogdm9pZCB7XG4gICAgaWYgKGZvcm1MYXlvdXQuc2VjdGlvbkV4cGFuZGFibGUgJiYgZm9ybUxheW91dC5zZWN0aW9uRXhwYW5kYWJsZS5hbGxvd2VkKSB7XG4gICAgICBpZiAoZm9ybUxheW91dC5zZWN0aW9uRXhwYW5kYWJsZS5kZWZhdWx0ID09IEZvcm1TZWN0aW9uRXhwYW5kLkVYUEFORCkge1xuICAgICAgICBmb3JtTGF5b3V0LnNlY3Rpb25FeHBhbmRhYmxlLmRlZmF1bHQgPSBGb3JtU2VjdGlvbkV4cGFuZC5DT0xMQVBTRTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm1MYXlvdXQuc2VjdGlvbkV4cGFuZGFibGUuZGVmYXVsdCA9IEZvcm1TZWN0aW9uRXhwYW5kLkVYUEFORDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRMYXlvdXQoKTogdm9pZCB7XG4gICAgdGhpcy5icmVha3BvaW50U3Vic2NyaXB0aW9uID0gdGhpcy5icmVha3BvaW50T2JzZXJ2ZXIub2JzZXJ2ZShbXG4gICAgICBCcmVha3BvaW50cy5YU21hbGwsXG4gICAgICBCcmVha3BvaW50cy5TbWFsbCxcbiAgICAgIEJyZWFrcG9pbnRzLk1lZGl1bSxcbiAgICAgIEJyZWFrcG9pbnRzLkxhcmdlLFxuICAgICAgQnJlYWtwb2ludHMuWExhcmdlXG4gICAgXSkuc3Vic2NyaWJlKChzdGF0ZTogQnJlYWtwb2ludFN0YXRlKSA9PiB7XG4gICAgICBpZiAoc3RhdGUuYnJlYWtwb2ludHNbQnJlYWtwb2ludHMuWFNtYWxsXSkge1xuICAgICAgICB0aGlzLmlzTW9iaWxlID0gdHJ1ZTtcbiAgICAgICAgY29uc29sZS5sb2coJ01hdGNoZXMgWFNtYWxsIHZpZXdwb3J0Jyk7XG4gICAgICB9XG4gICAgICBpZiAoc3RhdGUuYnJlYWtwb2ludHNbQnJlYWtwb2ludHMuU21hbGxdKSB7XG4gICAgICAgIHRoaXMuaXNUYWJsZXQgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZygnTWF0Y2hlcyBTbWFsbCB2aWV3cG9ydCcpO1xuICAgICAgfVxuICAgICAgaWYgKHN0YXRlLmJyZWFrcG9pbnRzW0JyZWFrcG9pbnRzLk1lZGl1bV0pIHtcbiAgICAgICAgdGhpcy5pc0Rlc2t0b3AgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLmxvZygnTWF0Y2hlcyBNZWRpdW0gIHZpZXdwb3J0Jyk7XG4gICAgICB9XG4gICAgICBpZiAoc3RhdGUuYnJlYWtwb2ludHNbQnJlYWtwb2ludHMuTGFyZ2VdKSB7XG4gICAgICAgIHRoaXMuaXNEZXNrdG9wID0gdHJ1ZTtcbiAgICAgICAgY29uc29sZS5sb2coJ01hdGNoZXMgTGFyZ2Ugdmlld3BvcnQnKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdGF0ZS5icmVha3BvaW50c1tCcmVha3BvaW50cy5YTGFyZ2VdKSB7XG4gICAgICAgIHRoaXMuaXNEZXNrdG9wID0gdHJ1ZTtcbiAgICAgICAgY29uc29sZS5sb2coJ01hdGNoZXMgWExhcmdlIHZpZXdwb3J0Jyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucmVzZXRCdXR0b25EaXNwbGF5KCk7XG4gICAgICB0aGlzLnJlc2V0RGlzcGxheUluQ29sdW1uKCk7XG4gICAgfSk7XG4gIH1cblxuICByZXNldEJ1dHRvbkRpc3BsYXkoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZm9ybUNvbmZpZyAmJiB0aGlzLmZvcm1Db25maWcuYWN0aW9uICYmICFDb2xsZWN0aW9uVXRpbHMuaXNFbXB0eSgoPEZvcm1CdXR0b24+dGhpcy5mb3JtQ29uZmlnLmFjdGlvbikuYnV0dG9ucykpIHtcbiAgICAgIGlmICgodGhpcy5pc01vYmlsZSB8fCB0aGlzLmlzVGFibGV0KSAmJiAhQnV0dG9uVXRpbHMuaGFzV2lkdGgoKDxGb3JtQnV0dG9uPnRoaXMuZm9ybUNvbmZpZy5hY3Rpb24pLmJ1dHRvbnMpKSB7XG4gICAgICAgIEJ1dHRvblV0aWxzLnNldEVxdWFsV2lkdGgoKDxGb3JtQnV0dG9uPnRoaXMuZm9ybUNvbmZpZy5hY3Rpb24pLmJ1dHRvbnMpO1xuICAgICAgfVxuICAgIH0gXG4gIH1cblxuICByZXNldERpc3BsYXlJbkNvbHVtbigpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5mb3JtQ29uZmlnICYmIHRoaXMuZm9ybUNvbmZpZy5kaXNwbGF5SW5Db2x1bW5zKSB7XG4gICAgICBpZiAodGhpcy5pc01vYmlsZSkge1xuICAgICAgICB0aGlzLmNlbGxDb3VudCA9IDQ7XG4gICAgICAgIHRoaXMuZm9ybUNvbmZpZy5kaXNwbGF5SW5Db2x1bW5zID0gdGhpcy5nZXROZXdEaXNwbGF5SW5Db2x1bW4oXCJtb2JpbGVcIiwgdGhpcy5mb3JtQ29uZmlnLmRpc3BsYXlJbkNvbHVtbnMpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaXNUYWJsZXQpIHtcbiAgICAgICAgdGhpcy5jZWxsQ291bnQgPSA4O1xuICAgICAgICB0aGlzLmZvcm1Db25maWcuZGlzcGxheUluQ29sdW1ucyA9IHRoaXMuZ2V0TmV3RGlzcGxheUluQ29sdW1uKFwidGFibGV0XCIsIHRoaXMuZm9ybUNvbmZpZy5kaXNwbGF5SW5Db2x1bW5zKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5mb3JtQ29uZmlnICYmICFDb2xsZWN0aW9uVXRpbHMuaXNFbXB0eSh0aGlzLmZvcm1Db25maWcuZm9ybUZpZWxkcykpIHtcbiAgICAgIHRoaXMuZm9ybUNvbmZpZy5mb3JtRmllbGRzLmZvckVhY2goZm9ybUZpZWxkID0+IHtcbiAgICAgICAgaWYgKGZvcm1GaWVsZC5kaXNwbGF5SW5Db2x1bW5zKSB7XG4gICAgICAgICAgaWYgKHRoaXMuaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuY2VsbENvdW50ID0gNDtcbiAgICAgICAgICAgIGZvcm1GaWVsZC5kaXNwbGF5SW5Db2x1bW5zID0gdGhpcy5nZXROZXdEaXNwbGF5SW5Db2x1bW4oXCJtb2JpbGVcIiwgZm9ybUZpZWxkLmRpc3BsYXlJbkNvbHVtbnMpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5pc1RhYmxldCkge1xuICAgICAgICAgICAgdGhpcy5jZWxsQ291bnQgPSA4O1xuICAgICAgICAgICAgZm9ybUZpZWxkLmRpc3BsYXlJbkNvbHVtbnMgPSB0aGlzLmdldE5ld0Rpc3BsYXlJbkNvbHVtbihcInRhYmxldFwiLCBmb3JtRmllbGQuZGlzcGxheUluQ29sdW1ucyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgIHsgXG4gICAgICAgICAgZm9ybUZpZWxkLmRpc3BsYXlJbkNvbHVtbnMgPSAxO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIHRoaXMuZmllbGREZWZhdWx0U2V0dGluZygpO1xuICAgIHRoaXMudHJhbnNmb3JtUm93cygpO1xuICB9XG5cbiAgZ2V0TmV3RGlzcGxheUluQ29sdW1uKGRldmljZTogc3RyaW5nLCBkaXNwbGF5SW5Db2x1bW46IG51bWJlcik6IG51bWJlciB7XG4gICAgbGV0IGRpc3BsYXlJbkNvbHVtbk1hcDogTWFwPHN0cmluZywgTWFwPG51bWJlciwgbnVtYmVyPj4gPSBuZXcgTWFwPHN0cmluZywgTWFwPG51bWJlciwgbnVtYmVyPj4oKTtcblxuICAgIGxldCBtb2JpbGVNYXA6IE1hcDxudW1iZXIsIG51bWJlcj4gPSBuZXcgTWFwPG51bWJlciwgbnVtYmVyPigpO1xuICAgIG1vYmlsZU1hcC5zZXQoMTIsIDEpO1xuICAgIG1vYmlsZU1hcC5zZXQoMTEsIDEpO1xuICAgIG1vYmlsZU1hcC5zZXQoMTAsIDEpO1xuICAgIG1vYmlsZU1hcC5zZXQoOSwgMSk7XG4gICAgbW9iaWxlTWFwLnNldCg4LCAxKTtcbiAgICBtb2JpbGVNYXAuc2V0KDcsIDEpO1xuICAgIG1vYmlsZU1hcC5zZXQoNiwgMSk7XG4gICAgbW9iaWxlTWFwLnNldCg1LCAxKTtcbiAgICBtb2JpbGVNYXAuc2V0KDQsIDEpO1xuICAgIG1vYmlsZU1hcC5zZXQoMywgMSk7XG4gICAgbW9iaWxlTWFwLnNldCgyLCAxKTtcbiAgICBtb2JpbGVNYXAuc2V0KDEsIDEpO1xuICAgIGRpc3BsYXlJbkNvbHVtbk1hcC5zZXQoXCJtb2JpbGVcIiwgbW9iaWxlTWFwKTtcblxuICAgIGxldCB0YWJsZXRNYXA6IE1hcDxudW1iZXIsIG51bWJlcj4gPSBuZXcgTWFwPG51bWJlciwgbnVtYmVyPigpO1xuICAgIHRhYmxldE1hcC5zZXQoMTIsIDIpO1xuICAgIHRhYmxldE1hcC5zZXQoMTEsIDIpO1xuICAgIHRhYmxldE1hcC5zZXQoMTAsIDIpO1xuICAgIHRhYmxldE1hcC5zZXQoOSwgMik7XG4gICAgdGFibGV0TWFwLnNldCg4LCAyKTtcbiAgICB0YWJsZXRNYXAuc2V0KDcsIDIpO1xuICAgIHRhYmxldE1hcC5zZXQoNiwgMik7XG4gICAgdGFibGV0TWFwLnNldCg1LCAyKTtcbiAgICB0YWJsZXRNYXAuc2V0KDQsIDIpO1xuICAgIHRhYmxldE1hcC5zZXQoMywgMik7XG4gICAgdGFibGV0TWFwLnNldCgyLCAyKTtcbiAgICB0YWJsZXRNYXAuc2V0KDEsIDEpO1xuICAgIGRpc3BsYXlJbkNvbHVtbk1hcC5zZXQoXCJ0YWJsZXRcIiwgdGFibGV0TWFwKTtcblxuICAgIHJldHVybiBkaXNwbGF5SW5Db2x1bW5NYXAuZ2V0KGRldmljZSkuZ2V0KGRpc3BsYXlJbkNvbHVtbik7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5icmVha3BvaW50U3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLmJyZWFrcG9pbnRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==